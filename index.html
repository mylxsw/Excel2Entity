<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-dark.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>Excel2entity by mylxsw</title>
  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h1>Excel2entity</h1>
          <h2>该项目实现批量导入Excel记录时，自动转换行为Java实体对象</h2>
        </header>

        <section id="downloads" class="clearfix">
          <a href="https://github.com/mylxsw/Excel2Entity/zipball/master" id="download-zip" class="button"><span>Download .zip</span></a>
          <a href="https://github.com/mylxsw/Excel2Entity/tarball/master" id="download-tar-gz" class="button"><span>Download .tar.gz</span></a>
          <a href="https://github.com/mylxsw/Excel2Entity" id="view-on-github" class="button"><span>View on GitHub</span></a>
        </section>

        <hr>

        <section id="main_content">
          <h1>
<a id="excel2entity" class="anchor" href="#excel2entity" aria-hidden="true"><span class="octicon octicon-link"></span></a>Excel2Entity</h1>

<p>Excel2Entity对<code>Java POI</code>对<code>xls</code>文件的读取进行了封装，实现了批量导入Excel中的数据时自动根据Excel中的数据行创建对应的<code>Java POJO</code>实体对象。</p>

<p>该类库也实现了在创建实体对象时对字段类型进行校验，可以对Excel中的数据类型合法性进行校验，通过实现扩展接口，可以实现自定义校验规则以及自定义实体对象字段类型等更加复杂的校验规则和字段类型转换。</p>

<h3>
<a id="依赖" class="anchor" href="#%E4%BE%9D%E8%B5%96" aria-hidden="true"><span class="octicon octicon-link"></span></a>依赖</h3>

<p>Excel2Entity依赖于<code>Apache POI</code>类库。</p>

<h3>
<a id="使用说明" class="anchor" href="#%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E" aria-hidden="true"><span class="octicon octicon-link"></span></a>使用说明</h3>

<h4>
<a id="普通实体创建" class="anchor" href="#%E6%99%AE%E9%80%9A%E5%AE%9E%E4%BD%93%E5%88%9B%E5%BB%BA" aria-hidden="true"><span class="octicon octicon-link"></span></a>普通实体创建</h4>

<pre><code>    ExcelHelper eh = ExcelHelper.readExcel("111.xls");
    List&lt;Demo&gt; entitys  = null;
    try {
        entitys = eh.toEntitys(Demo.class);
        for (Demo d : entitys) {
            System.out.println(d.toString());
        }
    } catch (ExcelParseException e) {
        System.out.println(e.getMessage());
    } catch (ExcelContentInvalidException e) {
        System.out.println(e.getMessage());
    } catch (ExcelRegexpValidFailedException e) {
        System.out.println(e.getMessage());
    }
</code></pre>

<h4>
<a id="注册新的字段类型" class="anchor" href="#%E6%B3%A8%E5%86%8C%E6%96%B0%E7%9A%84%E5%AD%97%E6%AE%B5%E7%B1%BB%E5%9E%8B" aria-hidden="true"><span class="octicon octicon-link"></span></a>注册新的字段类型</h4>

<p>注册的新的字段类型类必须实现ExcelType抽象类。</p>

<pre><code>ExcelHelper.registerNewType(MyDataType.class);
</code></pre>

<h4>
<a id="实体对象" class="anchor" href="#%E5%AE%9E%E4%BD%93%E5%AF%B9%E8%B1%A1" aria-hidden="true"><span class="octicon octicon-link"></span></a>实体对象</h4>

<p>实体类必须标注@ExcelEntity注解， 同时需要填充的字段标注@ExcelProperty注解</p>

<pre><code>@ExcelEntity
public class Demo {
    @ExcelProperty(value="Name", rule=MyStringCheckRule.class)
    private String name;

    @ExcelProperty("Sex")
    private String sex;
        // 基于正则表达式的字段校验
    @ExcelProperty(value="Age", regexp="^[1-4]{1}[0-9]{1}$", regexpErrorMessage="年龄必须在10-49岁之间")
    private int age;

    @ExcelProperty(value="Tel")
    private Long tel;

    @ExcelProperty("创建时间")
    private Timestamp createDate;

    @ExcelProperty(value="Name", required=true)
    private MyDataType name2;


... [get/set方法]
}
</code></pre>

<h4>
<a id="自定义校验规则" class="anchor" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%A0%A1%E9%AA%8C%E8%A7%84%E5%88%99" aria-hidden="true"><span class="octicon octicon-link"></span></a>自定义校验规则</h4>

<p>自定义校验规则必须实现ExcelRule接口</p>

<pre><code>public class MyStringCheckRule implements ExcelRule&lt;String&gt; {
        // 字段检查
    public void check(Object value, String columnName, String fieldName) throws ExcelContentInvalidException {
        String val = (String) value;
        System.out.println("--------&gt;   检测的列名为  " + columnName + "， 填充的字段名为 " + fieldName );
        if(val.length() &gt; 10){
            throw new ExcelContentInvalidException("内容超长!");
        }
    }
        // 结果修改
    public String filter(Object value, String columnName, String fieldName) {
        String val = (String) value;
        return "[[[[" + val + "]]]";
    }

}
</code></pre>
        </section>

        <footer>
          Excel2entity is maintained by <a href="https://github.com/mylxsw">mylxsw</a><br>
          This page was generated by <a href="https://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
        </footer>

        
      </div>
    </div>
  </body>
</html>
